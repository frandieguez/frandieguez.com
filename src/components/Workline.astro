---
import { isNoSubstitutionTemplateLiteral } from "typescript";

interface WorkImage {
  src: string;         // ruta p√∫blica (/work/xyz.png)
  alt?: string;
  class?: string;      // utilidades extra (ej: "rotate-1 md:rotate-0")
}

interface WorkItem {
  eyebrow?: string;    // ‚ÄúCLIENT / PRODUCT‚Äù mini t√≠tulo
  title: string;       // T√≠tulo grande
  subtitle?: string;   // L√≠nea secundaria (rol, fecha, etc.)
  description?: string;
  ctaHref?: string;
  ctaLabel?: string;
  images: WorkImage[]; // entre 2 y 6 queda perfecto
}

// üîß Datos de ejemplo: cambia rutas y textos
const items = [
  {
    title: "SITUM ‚Ä¢ Indoor Maps",
    eyebrow: "Map Viewer & 3D Layers",
    subtitle: ["Tech Lead ‚Äî 2020‚ÄìNow", "Senior Software Developer ‚Äî 2019‚Äì2020"],
    description:
      "Currently, I lead the web technology at Situm ‚Äî an innovative company providing indoor positioning solutions for people and robots across multiple industries. My work focuses on designing and developing the visual layer of Situm‚Äôs products, transforming complex spatial data into intuitive, high-performance web experiences that power advanced Business Intelligence insights.",
    ctaHref: "https://situm.com",
    ctaLabel: "Visit the site",
    images: [
      { src: "/images/projects/situm/1.jpeg" },
      { src: "/images/projects/situm/2.jpeg" },
      { src: "/images/projects/situm/3.png" },
      { src: "/images/projects/situm/4.png" },
    ],
  },

  {
    title: "GNOME ‚Ä¢ Open Source Project",
    eyebrow: "Contributions and Galician translations",
    subtitle: ["Maintainer / Contributor ‚Äî 2006‚ÄìNow"],
    description:
      "For over 20 years, I‚Äôve been contributing to the GNOME project ‚Äî not only translating its modules into Galician, but also developing and maintaining i18n tools that improve and streamline the translation workflow for contributors worldwide.",
    ctaHref: "https://l10n.gnome.org/teams/gl",
    ctaLabel: "Visit the site",
    images: [
      { src: "/images/projects/gnome/1.png" },
      { src: "/images/projects/gnome/2.png" },
    ],
  },

  {
    title: "OpenHost",
    eyebrow: "High-performance news publishing platform",
    subtitle: ["Head of Research and Development ‚Äî 2009‚Äì2019"],
    description:
      "Before joining Situm, I dedicated a decade to building high-performance tools and large-scale systems for the media industry. As Head of R&D, I led the development of OpenHost ‚Äî a robust news publishing platform that empowered journalists to efficiently manage and deliver online content to millions of readers.",
    ctaHref: "http://www.opennemas.com/",
    ctaLabel: "Visit the site",
    images: [
      { src: "/images/projects/opennemas/1.jpeg" },
      { src: "/images/projects/opennemas/2.jpeg" },
    ],
  },

  {
    title: "University of Santiago de Compostela",
    eyebrow: "Open Source Consultant",
    description:
      "Earlier in my career, I worked as an open-source software consultant at the University of Santiago de Compostela, where I developed a custom Linux-based desktop to simplify administrative workflows and led large-scale migrations to open-source software in educational environments. This initiative earned the Libre Software Award in Galicia, Spain.",
    link: "http://www.mancomun.org/es/no_cache/actualidade/detalledenova/nova/a-osl-da-usc-gana-o-premio-eganet-2009-na-categoria-software-libre/",
    images: [
      { src: "/images/projects/oslusc/1.jpeg" },
      { src: "/images/projects/oslusc/2.jpeg" },
      { src: "/images/projects/oslusc/3.jpeg" },
    ],
  },
];
---

<section class="relative mx-auto max-w-6xl">
  <!-- l√≠nea de timeline -->
  <div class="pointer-events-none absolute left-[1.15rem] top-0 h-full w-px bg-gradient-to-b bg-[hsl(var(--theme-accent-two))]/40 via-[hsl(var(--theme-accent-two))]/20 to-transparent md:left-8"></div>

  <h2 class="mb-12 pl-10 !text-3xl font-extrabold tracking-tight md:pl-16">Work</h2>

  <div class="space-y-24">
    {items.map((w, i) => (
      <article class="relative">
        {/* marca del timeline */}
        <div class="absolute left-2 top-2 h-5 w-5 rounded-full bg-[hsl(var(--theme-accent-two))] ring-8 ring-orange-400/10 md:left-5 ml-[2px]"></div>

        <div class="grid grid-cols-1 gap-8 md:grid-cols-5 md:gap-12 pl-8 md:pl-0">
          {/* texto */}
          <header class="md:col-span-2 md:pl-16">
            {w.eyebrow && (
              <p class="mb-1 mt-2 text-xs font-semibold uppercase tracking-widest text-[hsl(var(--theme-accent-two))]">
                {w.eyebrow}
              </p>
            )}
            <h3 class="!text-xl font-bold leading-tight mt-2">{w.title}</h3>
            <div>
            {w.subtitle && w.subtitle.map((sub, idx) => (
              <div key={idx} class="text-sm text-zinc-600 dark:text-zinc-400">{sub}</div>
            ))}
            </div>
            {w.description && (
              <p class="mt-4 text-zinc-700 dark:text-zinc-300">{w.description}</p>
            )}
            {w.ctaHref && w.ctaLabel && (
              <a
                href={w.ctaHref}
                target="_blank"
                rel="noopener noreferrer"
                class="mt-4 inline-flex items-center gap-2 rounded-xl border border-zinc-200 px-4 py-2 text-sm font-medium text-zinc-800 shadow-sm hover:border-zinc-300 hover:shadow-md dark:border-zinc-700 dark:text-zinc-100"
              >
                {w.ctaLabel}
                <svg width="14" height="14" viewBox="0 0 24 24" class="opacity-70">
                  <path fill="currentColor" d="M21 14l-7 7l-1.414-1.414L17.172 15H4v-2h13.172l-4.586-4.586L14 7l7 7z"/>
                </svg>
              </a>
            )}
          </header>

          {/* mosaico de im√°genes */}
          <div class="md:col-span-3">
            <div
              class="relative grid grid-cols-2 gap-3 sm:grid-cols-3 md:grid-cols-3"
            >
              {w.images.map((img, idx) => (
                <figure
                  class={[
                    // tarjeta mockup
                    "aspect-[4/3] overflow-hidden rounded-2xl border border-black/5 bg-white/70 shadow-[0_10px_30px_rgba(0,0,0,0.12)] backdrop-blur",
                    "dark:bg-zinc-900/60 dark:border-white/5",
                    // sutiles rotaciones como en el ejemplo
                    idx % 3 === 0 ? "rotate-[-1.5deg]" : idx % 3 === 1 ? "rotate-[1deg]" : "rotate-[0.5deg]",
                    "transition-transform hover:rotate-0"
                  ].join(" ")}
                >
                  <img
                    src={img.src}
                    alt={img.alt ?? w.title}
                    class={["h-full w-full object-cover", img.class ?? ""].join(" ")}
                    loading="lazy"
                  />
                </figure>
              ))}
              {/* glow suave detr√°s del mosaico */}
              <div class="pointer-events-none absolute inset-0 -z-10 rounded-[2rem] blur-2xl"
                   style="background: radial-gradient(60% 50% at 50% 50%, rgba(16,185,129,0.15), transparent 70%);">
              </div>
            </div>
          </div>
        </div>
      </article>
    ))}
  </div>
</section>